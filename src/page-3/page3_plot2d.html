<!DOCTYPE html>
<html>
<head>
  <title>Tuning PlaySite.js</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <style>
    .slider {
      position: relative;
      width: 200px;
      margin-left: +400px;
    }
    .slider input {
      width: 100%;
    }
    .slider-labels {
      position: absolute;
      left: 0;
      width: 100%;
      top: 58px;
      display: flex;
      justify-content: space-between;
      margin-bottom: 100px;
      font-family: sans-serif;
      font-size: 14px;
    }
    .beta2-text {
  text-align: center;
  position: relative;
  top: 20px;
}
    .label-left {
  position: absolute;
  left: 0;
}

  .label-middle {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
  }

  .label-right {
    position: absolute;
    right: 0;
  }
    .line {
      fill: none;
      stroke: #ffab00;
      stroke-width: 3;
    }
    .axis-label {
      font-family: sans-serif;
      font-size: 12px;
      font-weight: bold;
    }
    .axis path,
    .axis line {
      fill: none;
      stroke: #ccc;
      shape-rendering: crispEdges;
    }
    .axis text {
      font-family: sans-serif;
      font-size: 10px;
    }
  </style>
</head>
<body>
  <div class="slider">
    <div class="slider-labels">
      <span class="label-left">0.99</span>
      <span class="label-middle">0.999</span>
      <span class="label-right">0.9999</span>
    </div>
    <p class="beta2-text">Beta2 = <span id="sliderValue">0.999</span></p>
    <input type="range" min="0" max="2" value="1" step="1" id="mySlider">
  </div>
  <svg width="400" height="300"></svg>

  <script>
    // data 
    const alpha = [-3.8, -3.6, -3.5, -3, -2.8, -2.5, -2.3, -2, -1.9];
    const rms1d =  [140, 140, 130, 110, 140, 140, 140, 140, 140];
    const adam1d = [140, 140, 128, 110, 108, 103, 140, 140, 140];
    const rms2d =  [140, 140, 138, 140, 140, 140, 140, 140, 140];
    const adam2d = [140, 140, 123, 110, 113, 140, 140, 140, 140];
    const rms3d =  [140, 140, 140, 140, 140, 140, 140, 140, 140];
    const adam3d = [140, 140, 123, 110, 111, 115, 118, 122, 140];

    // Set up the SVG
    const svg = d3.select("svg");
    const margin = { top: 20, right: 20, bottom: 40, left: 60 };
    const width = +svg.attr("width") - margin.left - margin.right;
    const height = +svg.attr("height") - margin.top - margin.bottom;
    const g = svg.append("g").attr("transform", `translate(${margin.left}, ${margin.top})`);

     // X-axis
    const xScale = d3.scaleLinear()
      .domain([0, alpha.length - 1])
      .range([0, width]);
   
    let xtickLabels = [-5,-4,-3,-2,-1];  

    const xAxis = d3.axisBottom(xScale)
      .ticks(5)      
      .tickFormat((d, i) => xtickLabels[i]);

    // Y-axis
    const yScale = d3.scaleLinear()
      .domain([100, 140]) // Adjusted y-axis domain for better visualization
      .range([height, 0]);
    
    const yAxis = d3.axisLeft(yScale).ticks(2);  

    // Create the line generator
    const line = d3.line()
      .x((d, i) => xScale(i))
      .y(d => yScale(d) );
    

    // Initial line plot
    const pathrms1d = g.append("path")
      .datum(rms1d)
      .attr("class", "line")
      .style("stroke", "green")
      .attr("d", line)
      .style("display", "none");

    const pathadam1d = g.append("path")
      .datum(adam1d)
      .attr("class", "line")
      .style("stroke", "red")
      .attr("d", line)
      .style("display", "none");

    const pathrms2d = g.append("path")
      .datum(rms2d)
      .attr("class", "line")
      .style("stroke", "green")
      .attr("d", line);
      

    const pathadam2d = g.append("path")
      .datum(adam2d)
      .attr("class", "line")
      .style("stroke", "red")
      .attr("d", line);
      

    const pathrms3d = g.append("path")
      .datum(rms3d)
      .attr("class", "line")
      .style("stroke", "green")
      .attr("d", line)
      .style("display", "none");

    const pathadam3d = g.append("path")
      .datum(adam3d)
      .attr("class", "line")
      .style("stroke", "red")
      .attr("d", line)
      .style("display", "none");

    // X-axis label
    g.append("text")
      .attr("class", "axis-label")
      .attr("text-anchor", "middle")
      .attr("transform", `translate(${width / 2}, ${height + margin.bottom - 10})`)
      .text("Alpha Epochs100 Beta1=0.9");

    // Y-axis label
    g.append("text")
      .attr("class", "axis-label")
      .attr("text-anchor", "middle")
      .attr("transform", `translate(${-margin.left + 10}, ${height / 2})rotate(-90)`)
      .text("Loss");

   

    g.append("g")
      .attr("class", "x-axis")
      .attr("transform", `translate(0, ${height})`)
      .call(xAxis);
    

    g.append("g")
      .attr("class", "y-axis")
      .call(yAxis);

    // Slider functionality
    const slider = d3.select("#mySlider");
    const sliderValue = d3.select("#sliderValue");
    slider.on("input", function() {
      const value = +this.value;
      sliderValue.text(value === 0 ? "0.99" : value === 1 ? "0.999" : "0.9999");

      // Show/hide line plots based on slider position
      if (value === 0) {
        //alert("0");
        pathrms1d.style("display", "block");
        pathadam1d.style("display", "block");
        pathrms2d.style("display", "none");
        pathadam2d.style("display", "none");
        pathrms3d.style("display", "none");
        pathadam3d.style("display", "none");
      } else if (value === 1) {
        //alert("1");
        pathrms1d.style("display", "none");
        pathadam1d.style("display", "none");
        pathrms2d.style("display", "block");        
        pathadam2d.style("display", "block");
        pathrms3d.style("display", "none");
        pathadam3d.style("display", "none");
      } else {
        //alert("2");
        pathrms1d.style("display", "none");
        pathadam1d.style("display", "none");
        pathrms2d.style("display", "none");
        pathadam2d.style("display", "none");
        pathrms3d.style("display", "block");
        pathadam3d.style("display", "block");
      }
    });

    // Define legend data
const legendData = [
  { label: "RMSprop", color: "green" },
  { label: "Adam", color: "red" }
];

// Add legend
const legend = g.append("g")
  .attr("class", "legend")
  .attr("transform", `translate(${width - 100}, 20)`); // Adjust the translation as needed

// Add legend items
const legendItems = legend.selectAll(".legend-item")
  .data(legendData)
  .enter()
  .append("g")
  .attr("class", "legend-item")
  .attr("transform", (d, i) => `translate(0, ${i * 20})`); // Adjust the vertical spacing as needed

// Add legend lines
legendItems.append("line")
  .attr("x1", 0)
  .attr("y1", 5)
  .attr("x2", 20)
  .attr("y2", 5)
  .style("stroke", d => d.color)
  .style("stroke-width", 2);

// Add legend labels
legendItems.append("text")
  .attr("x", 25)
  .attr("y", 9)
  .text(d => d.label)
  .style("font-family", "sans-serif")
  .style("font-size", "12px");

  </script>
</body>
</html>
